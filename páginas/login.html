<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>InfraSport - Login</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link rel="stylesheet" href="../assets/css/login.css" />
    <link rel="stylesheet" href="../assets/css/home-page.css" />
  </head>
  <body>
    <!-- Cabeçalho -->
    <header>
      <nav class="navbar">
        <div class="nav-left">
          <img src="Logo_InfraSports-sem fundo.png" alt="Logo InfraSport" />
        </div>
        <ul class="nav-right">
          <li><a href="mapa.html"><i class="fas fa-map"></i> Mapa</a></li>
          <li><a href="espaços.html"><i class="fas fa-tree"></i> Espaços</a></li>
          <li><a href="Cadas_Local.html"><i class="fas fa-plus-circle"></i> Cadastrar</a></li>
          <li><a href="aval.html"><i class="fas fa-star"></i> Avaliar</a></li>
          <li><a href="login.html"><i class="fas fa-user"></i> Conta</a></li>
        </ul>
      </nav>
    </header>

    <!-- Conteúdo Principal -->
    <main class="container">
      <div class="logo-area">
        <div class="logo">
          <h2><span>Infra</span>Sport</h2>
        </div>
      </div>

      <section class="login-box">
        <h2>Entrar no InfraSport</h2>
        <form id="loginForm">
          <label for="login">Usuário</label>
          <input type="text" id="login" name="login" required placeholder="Digite seu login" />

          <label for="senha">Senha</label>
          <input type="password" id="senha" name="senha" required placeholder="Digite sua senha" />

          <div class="login-links">
            <a href="esqueceu-senha.html">Esqueceu a senha?</a>
            <a href="cadastro-atleta.html" class="cadastro-link">Cadastrar-se</a>
          </div>

          <button type="submit">Entrar</button>
          <p id="mensagemErro" class="erro-login"></p>
        </form>
      </section>
    </main>

    <!-- Rodapé -->
    <footer class="rodape">
      <div class="container rodape-container">
        <p>© 2025 InfraSport | Prefeitura de Belo Horizonte | Secretaria de Mobilidade Urbana</p>
        <div class="redes-sociais">
          <a href="#"><i class="fab fa-facebook"></i></a>
          <a href="#"><i class="fab fa-instagram"></i></a>
          <a href="#"><i class="fab fa-twitter"></i></a>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
<script src="../assets/js/login-app.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    initLoginApp();

    const form = document.getElementById("loginForm");
    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const login = document.getElementById("login").value.trim();
      const senha = document.getElementById("senha").value.trim();

      // Aguarda usuários antes de autenticar
      await carregarUsuarios(() => {
        const sucesso = loginUser(login, senha);
        if (sucesso) {
          const destino = sessionStorage.getItem("returnURL") || "/index.html";
          window.location.href = destino;
        } else {
          document.getElementById("mensagemErro").textContent = "Usuário ou senha inválidos.";
        }
      });
    });
  });
</script>
  </body>
</html>
